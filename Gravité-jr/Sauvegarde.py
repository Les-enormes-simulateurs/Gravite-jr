import numpy as np
import pickle
import os
from func_lagrange import l1, l2, l3, l4, l5

M_1 = 50.972e24
# M_1 = 1.183852642837549e+28
M_2 = 7.34767309 * 10 ** 23
G = 6.67430 * 10 ** (-11)
brun = [0.25, 0, 0.06]
jaune = [1, 1, 0]
mauveiguess = [1, 0, 1]
surprise = [0, 1, 1]
dicto = {"objets_1": [
    [
        (5.972 * 10 ** 24, [0, 0, 0], [0, 0, 0], [0, 0, 1]),
        (7.34767309 * 10 ** 22, [0, 1750, -600], [40000000, 0, 0], [0.5, 0.5, 0.5]),
        (1000, [0, 7700, 2000], [7000000, 0, 0], [0, 1, 0]),
        (1.0 * 10 ** 21, [0, 0, -6700], [-8000000, 0, 0], [1, 0, 0])
    ],
    []
]}
k = 2 * np.pi / 5
d = 200000000
v = np.sqrt(6.67430 * 10 ** (-11) * 6.0 * 10 ** 27 / d)
dicto["objets_2"] = [
    [
        (6.0 * 10 ** 27, [0, 0, 0], [0, 0, 0], [0.25, 0, 0.06]),
        (6.0 * 10 ** 24, [0, v, 0], [d, 0, 0], mauveiguess),
        (6.0 * 10 ** 24, [v * np.cos(k + np.pi / 2), v * np.sin(k + np.pi / 2), 0], [d * np.cos(k), d * np.sin(k), 0], surprise),
        (6.0 * 10 ** 24, [v * np.cos(2 * k + np.pi / 2), v * np.sin(2 * k + np.pi / 2), 0],
         [d * np.cos(2 * k), d * np.sin(2 * k), 0], jaune),
        (6.0 * 10 ** 24, [v * np.cos(3 * k + np.pi / 2), v * np.sin(3 * k + np.pi / 2), 0],
         [d * np.cos(3 * k), d * np.sin(3 * k), 0], [0, 1, 0]),
        # (6.0 * 10 ** 24, [v*np.cos(4*k + np.pi/2), v*np.sin(4*k + np.pi/2), 0], [d * np.cos(4 * k), d * np.sin(4 * k), 0]),
    ],
    []
]
dicto["objets_3"] = [
    [
        (5.972 * 10 ** 24, [0, 0, 0], [0, 0, 0], [0, 0, 1]),
        (3.34767309 * 10 ** 23, [0, 900, -400], [80000000, 0, 0], [0, 1, 0]),
        (3.34767309 * 10 ** 21, [0, 5700, -400], [81000000, 0, 0], surprise),
        (1000, [0, 7440, 2000], [7000000, 0, 0], jaune),
        (1.0 * 10 ** 22, [0, 0, 6700], [8000000, 0, 0], mauveiguess)
    ],
    []
]

dicto["objets_4"] = [
    [
        (5.972 * 10 ** 24, [0, 0, 0], [0, 0, 0], [0, 0, 1]),
        (7.34767309 * 10 ** 23, [0, 1750, -600], [40000000, 0, 0], [0.5, 0.5, 0.5]),
        (1000, [0, 7700, 2000], [7000000, 0, 0], [0, 1, 0]),
        (1.0 * 10 ** 21, [0, 0, -6700], [-8000000, 0, 0], mauveiguess),
        (1.0 * 10 ** 23, [5000, 0, 5000], [0, 10000000, 0], jaune)
    ],
    []
]
dicto["objets_5"] = [
    [
        (5.972e24, [0, 0, 0], [0, 0, 0], [0, 0, 1, 1]),
        (7.34767309e23, [0, 1750, -600], [40000000, 0, 0], [0.5, 0.5, 0.5, 1]),
        (1000, [0, 7700, 2000], [7000000, 0, 0], [0, 1, 0, 1]),
        (1.0e21, [0, 0, -6700], [-8000000, 0, 0], [1, 0, 1, 1]),
        (1.0e23, [5000, 0, 5000], [0, 10000000, 0], [0, 1, 1, 1]),
        (1.0e21, [0, -7700, -2000], [-7000000, 0, 0], [1, 0, 1, 1]),
    ],
    []
]
D = 80000000
P = np.sqrt(4* np.pi**2*D**3/ G / (M_1 + M_2))
r = (1 - M_2 / (M_1 + M_2)) * D
R = D - r
v = 2 * np.pi * r / P
V = 2 * np.pi * R / P
r_cm = np.sqrt((D * (M_1 - M_2)/(M_1 + M_2) / 2 - R)**2 + (D * np.sqrt(3) / 2)**2)
v_particule = 2 * np.pi * r_cm / P
theta = np.arctan((D * np.sqrt(3) / 2) / (D * (M_1 - M_2)/(M_1 + M_2) / 2))
phi = np.arctan(np.sqrt(3) / (1 - 2 * M_2 / M_1))
dicto["objets_6"] = [
    [
        (M_1, [0, -V, 0], [-R, 0, 0], [0, 0, 1, 1]),
        (M_2, [0, v, 0], [r, 0, 0], [0.5, 0.5, 0.5, 1]),
        (1, [-v_particule*np.sin(theta), v_particule*np.cos(theta), 0], [D * (M_1 - M_2)/(M_1 + M_2) / 2, D * np.sqrt(3) / 2, 1000000], [0, 1, 0, 1]),
        (1, [-v_particule*np.sin(phi), v_particule*np.cos(phi), 0], [D * (0.5 - M_2 / M_1), D * np.sqrt(3) / 2, 0], [1, 1, 1])
    ],
    []
]
r_cm = D * np.sqrt((0.5 - M_2 / M_1)**2 + 3 / 4)
v_particule = 2 * np.pi * r_cm / P

dicto["objets_7"] = [
    [
        (M_1, [0, -V, 0], [-R, 0, 0], [0, 0, 1, 1]),
        (M_2, [0, v, 0], [r, 0, 0], [0.5, 0.5, 0.5, 1]),
        (1, [-v_particule*np.sin(phi), v_particule*np.cos(phi), 0], [D * (0.5 - M_2 / M_1), D * np.sqrt(3) / 2, 0], [0, 1, 0, 1]),
    ],
    []
]

dicto["objets_8"] = [
    [
        (M_1, [0, 0, 0], [0, 0, 0], [0, 0, 1, 1]),
        (M_2, [0, np.sqrt(G * M_1/D), 0], [D, 0, 0], [0, 1, 1, 1])
    ],
    []
]
L_1 = l1(M_1, M_2, D)
L_2 = l2(M_1, M_2, D)
L_3 = l3(M_1, M_2, D)
L_4 = l4(M_1, M_2, D)
L_5 = l5(M_1, M_2, D)
dicto["objets_9"] = [
    [
        (M_1, [0, -V, 0], [-R, 0, 0], [0, 0, 1]),
        (M_2, [0, v, 0], [r, 0, 0], [0.5, 0.5, 0.5]),
        (1, [-v_particule*np.sin(phi), v_particule*np.cos(phi), 0], [D * (0.5 - M_2 / M_1), D * np.sqrt(3) / 2, 0], [0, 1, 0]),
        (1, [v_particule*np.sin(phi), v_particule*np.cos(phi), 0], [D * (0.5 - M_2 / M_1), -D * np.sqrt(3) / 2, 0], [0, 1, 0]),
        (1, [0, 2 * np.pi * L_1[0] / P, 0], L_1, [0, 1, 0]),
        (1, [0, 2 * np.pi * L_2[0] / P, 0], L_2, [0, 1, 0]),
        (1, [0, 2 * np.pi * L_3[0] / P, 0], L_3, [0, 1, 0])
    ],
    []
]
v_particule = 6990
phi = np.arctan2(-D * np.cbrt(M_2 / (3 * (M_1 + M_2))), r)
phi -= 0.034
dicto["objets_10"] = [
    [
        (M_1, [0, -V, 0], [-R, 0, 0], [0, 0, 1]),
        (M_2, [0, v, 0], [r, 0, 0], [0.5, 0.5, 0.5]),
        # (1, [0, v, 0], [r * np.cos(phi), r * np.sin(phi), 0], [0, 1, 0])
        (1, [-v * np.sin(phi) - 10, v * np.cos(phi), 0], [r * np.cos(phi), r * np.sin(phi), 0], [0, 1, 0])
    ],
    []
]
os.remove("Sauvegarde.data")

fw = open("Sauvegarde.data", 'wb')
pickle.dump(dicto, fw)
fw.close()

# facteur = np.cbrt(3 / (4 * np.pi*5520))


# print(np.sqrt((D * (M_1 - M_2)/(M_1 + M_2) / 2)**2 + (D * np.sqrt(3) / 2)**2))
# print(f"v = {v}")
# print(f"v_particule = {v_particule}")
# k = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9])
# print(np.sqrt(k))


